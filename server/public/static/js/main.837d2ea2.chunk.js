(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{119:function(e,a,t){e.exports=t(136)},127:function(e,a,t){},135:function(e,a,t){},136:function(e,a,t){"use strict";t.r(a);var n=t(10),r=t(0),c=t.n(r),l=t(93),o=t.n(l),i=(t(127),t(182)),u=t(202),s=t(203),d=t(204),m=t(201),f=t(193),p=t(102),b=t(196),g=t(222),h=t(213),E=t(190),v=t(183),x=t(184),j=t(185),O=t(223),w=t(15),k=t(14),y=t(205),_=t(189),C=t(187),S=t(206),T=t(200),A=t(207),F=t(199),D=t(208),I=t(188),P=t(209),U=t(194),L=t(210),R=t(211),M=t(195),q=t(212),z=t(19),N=t(16),J=t(33),V=Object(J.b)({name:"request",initialState:{jwt:localStorage.getItem("jwt"),auth:!1,method:"POST",route:"",data:{},response:{}},reducers:{login:function(e,a){e.route="/api/user/login",e.method="POST",e.auth=!1,e.data=a.payload},register:function(e,a){e.route="/api/user/register",e.auth=!1,e.method="POST",e.data=a.payload},verify:function(e,a){e.route="/api/user/verify",e.auth=!1,e.method="POST",e.data=a.payload},list_user:function(e){e.route="/api/user/list",e.auth=!0,e.method="POST",e.data={}},edit_user:function(e,a){e.route="/api/user/edit",e.auth=!0,e.method="PATCH",e.data=a.payload},remove_user:function(e,a){e.route="/api/user/remove",e.auth=!0,e.method="POST",e.data=a.payload},add_user:function(e,a){e.route="/api/user/add",e.auth=!0,e.method="POST",e.data=a.payload},setJwt:function(e,a){null===a.payload?localStorage.removeItem("jwt"):localStorage.setItem("jwt",a.payload),e.jwt=a.payload},get_fobject_list:function(e,a){e.route="/api/fobject/list",e.auth=!0,e.method="POST",e.data={}},create_folder:function(e,a){e.route="/api/fobject/folder/add",e.auth=!0,e.method="POST",e.data=a.payload},remove_fobject:function(e,a){e.route="/api/fobject/remove",e.auth=!0,e.method="POST",e.data=a.payload},toggle_public_access:function(e,a){e.route="/api/fobject/access/public",e.auth=!0,e.method="POST",e.data=a.payload},change_access:function(e,a){e.route="/api/fobject/access/change",e.auth=!0,e.method="POST",e.data=a.payload},move_fobject:function(e,a){e.route="/api/fobject/move",e.auth=!0,e.method="POST",e.data=a.payload},response:function(e,a){e.response=a.payload}}}),H=V.actions,B=H.setJwt,G=H.login,W=H.register,X=H.response,K=H.verify,Q=H.add_user,Y=H.edit_user,Z=H.list_user,$=H.remove_user,ee=H.get_fobject_list,ae=H.create_folder,te=H.remove_fobject,ne=H.toggle_public_access,re=H.change_access,ce=H.move_fobject,le=V.reducer,oe=Object(J.b)({name:"storage",initialState:{fs:[],path:"/",current_parent:"/",current:[]},reducers:{setFs:function(e,a){e.fs=a.payload,e.current=a.payload.filter(function(a){return a.parent===e.current_parent}).map(function(e){return Object(w.a)({},e,{checked:!1,menu:!1,downloadValue:0})})},cd:function(e,a){e.path=function a(t,n){if("/"===t)return"/";var r=e.fs.find(function(e){return e._id===t});return"/"===r.parent?void 0===n?"/"+r.name:"/"+r.name+"/"+n:a(r.parent,void 0===n?r.name:r.name+"/"+n)}(a.payload),e.current_parent=a.payload,e.current=e.fs.filter(function(e){return e.parent===a.payload}).map(function(e){return Object(w.a)({},e,{checked:!1,menu:!1,downloadValue:0})})},setDownloadValue:function(e,a){e.current=e.current.map(function(e){return e._id===a.payload.fid&&(e.downloadValue=a.payload.value),e})},toggleSelectItem:function(e,a){var t=e.current.findIndex(function(e){return e._id===a.payload.fid});e.current[t].checked=!e.current[t].checked},unSelectAllItems:function(e){for(var a=0;a<e.current.length;a++)e.current[a].checked=!1},toggleMenuItem:function(e,a){var t=e.current.findIndex(function(e){return e._id===a.payload.fid});e.current[t].menu=!e.current[t].menu}}}),ie=oe.actions,ue=ie.setFs,se=ie.toggleMenuItem,de=ie.toggleSelectItem,me=ie.cd,fe=(ie.toggleAllSelectedItem,ie.unSelectAllItems),pe=ie.setDownloadValue,be=oe.reducer,ge=t(97),he=t(4),Ee=t(192),ve=Object(he.a)("li")(function(e){return{margin:e.theme.spacing(.5)}});function xe(e){var a=Object(ge.a)({},e),t=a.chipData,c=a.setChipData,l=r.useState(""),o=Object(n.a)(l,2),i=o[0],u=o[1];return r.createElement(r.Fragment,null,a.InputElement||r.createElement(F.a,{placeholder:a.placeholder||"",startAdornment:a.startAdornment||null,value:i,onChange:function(e){return u(e.target.value)},onKeyPress:function(e){"Enter"===e.key&&(e.preventDefault(),-1===t.indexOf(i)&&""!==i&&c([].concat(Object(k.a)(t),[i])),u(""))}}),r.createElement(T.a,{style:{minHeight:"40px"},sx:{display:"flex",flexWrap:"wrap",listStyle:"none",border:"2px dashed",borderColor:"background.primary",p:.5,m:0,mt:1,overflow:"hidden"},component:"ul"},0===t.length?void 0!==a.itemPlaceholder&&r.createElement(m.a,{sx:{textAlign:"center",width:"100%"},variant:"inherit"},a.itemPlaceholder):t.map(function(e,a){return r.createElement(ve,{key:a},r.createElement(Ee.a,{sx:{textOverflow:"ellipsis",maxWidth:"245px"},label:e,onDelete:(n=a,function(){var e=Object(k.a)(t);e.splice(n,1),c(e)})}));var n})))}var je=t(50),Oe={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",color:"text.default",border:"2px solid white",borderRadius:"15px",p:4};function we(){var e=Object(je.b)(),a=e.enqueueSnackbar,t=e.closeSnackbar,l=Object(z.c)(function(e){return e.request.jwt}),o=Object(z.c)(function(e){return e.user.data}),i=Object(z.b)(),g=Object(z.c)(function(e){return e.storage.current}),h=Object(z.c)(function(e){return e.storage.path}),E=Object(z.c)(function(e){return e.storage.current_parent}),v=Object(z.c)(function(e){return e.storage.fs}),x=Object(r.useState)(null),j=Object(n.a)(x,2),J=j[0],V=j[1],H=Object(r.useState)(!1),B=Object(n.a)(H,2),G=B[0],W=B[1],X=Object(r.useState)(!1),K=Object(n.a)(X,2),Q=K[0],Y=K[1],Z=Object(r.useState)(""),$=Object(n.a)(Z,2),le=$[0],oe=$[1],ie=Object(r.useState)(Oe),ue=Object(n.a)(ie,2),be=ue[0],ge=ue[1],he=Object(r.useState)([]),Ee=Object(n.a)(he,2),ve=Ee[0],we=Ee[1],ke=Object(r.useState)([]),ye=Object(n.a)(ke,2),_e=ye[0],Ce=ye[1],Se=Object(r.useState)(0),Te=Object(n.a)(Se,2),Ae=Te[0],Fe=Te[1],De=Object(r.useState)([]),Ie=Object(n.a)(De,2),Pe=Ie[0],Ue=Ie[1],Le=Object(r.useState)({name:"",public:!1}),Re=Object(n.a)(Le,2),Me=Re[0],qe=Re[1],ze=Object(N.f)(),Ne=function(e,n){var r,c=[e];if(G&&(r=c).push.apply(r,Object(k.a)(g.filter(function(e){return e.checked}).map(function(e){return e._id}))),(c=Object(k.a)(new Set(c))).includes(n)){var l=a("can't move one folder to him self",{variant:"error"});setTimeout(function(){t(l)},1e3)}else i(ce({fids:c,target:n}))};return Object(r.useEffect)(function(){null===l?ze("/login"):i(ee())},[]),Object(r.useEffect)(function(){Ue(_e.map(function(e){return e.name}))},[_e]),Object(r.useEffect)(function(){if(Pe.length<_e.length){var e=_e.filter(function(e){if(Pe.includes(e.name))return e});Ce(e)}},[Pe]),Object(r.useEffect)(function(){we([]),qe({name:"",public:!1}),oe(""),ge(Oe),Ce([]),Ue([]),Fe(0),Y(!1);var e=0;g.forEach(function(a){return a.checked&&e++}),W(!!e)},[g]),c.a.createElement(c.a.Fragment,null,c.a.createElement(u.a,{position:"sticky"},c.a.createElement(s.a,{sx:{backgroundColor:"background.secondary"}},c.a.createElement(d.a,{onClick:function(e){if("/"===h){var n=a("can't going upper than this");setTimeout(function(){t(n)},1e3)}else!function(){var e=h.split("/");e.splice(e.length-1,1);var a=e;a[0]="/";for(var t=a[a.length-1],n={name:"/",_id:"/"},r="/",c=1;n.name!==t;)n=v.find(function(e){return e.parent===r&&e.name===a[c]}),r=n._id,c++;i(me(n._id))}()}},c.a.createElement(y.a,null,"keyboard_backspace")),c.a.createElement(_.a,{sx:{marginLeft:"20px"},"aria-label":"breadcrumb",separator:"/"},"/"===h?c.a.createElement(m.a,{color:"text.primary"},"/"):h.split("/").map(function(e,a){return 0===a?e=c.a.createElement(m.a,{mt:.9},c.a.createElement(y.a,{fontSize:"small"},"home")):""===e&&(e=c.a.createElement(m.a,{mt:.9},c.a.createElement(y.a,{fontSize:"small"},"keyboard_double_arrow_right"))),c.a.createElement(f.a,{onDragOver:function(e){e.preventDefault()},onDrop:function(e){!function(e,a){var t=h.split("/");0===a?Ne(e,"/"):function(){var n=t.filter(function(e,t){return a>=t});n[0]="/";for(var r=n[n.length-1],c={name:"/",_id:"/"},l="/",o=1;c.name!==r;)c=v.find(function(e){return e.parent===l&&e.name===n[o]}),l=c._id,o++;Ne(e,c._id)}()}(e.dataTransfer.getData("fid"),a)},key:a,underline:"hover",color:"inherit",style:{cursor:"pointer"},onClick:function(e){!function(e){var a=h.split("/");0===e?i(me("/")):function(){var t=a.filter(function(a,t){return e>=t});t[0]="/";for(var n=t[t.length-1],r={name:"/",_id:"/"},c="/",l=1;r.name!==n;)r=v.find(function(e){return e.parent===c&&e.name===t[l]}),c=r._id,l++;i(me(r._id))}()}(a)}},e)})),c.a.createElement(O.a,{sx:{flexGrow:1}}),G&&c.a.createElement(d.a,{onClick:function(){W(!1),i(fe())}},c.a.createElement(y.a,null,"disabled_by_default")),c.a.createElement(d.a,{onClick:function(){oe("New Folder"),Y(!0)}},c.a.createElement(y.a,null,"create_new_folder")),c.a.createElement(d.a,{onClick:function(){oe("Upload Files"),Y(!0)}},c.a.createElement(y.a,null,"upload_file")))),c.a.createElement(C.a,{open:Q,onClose:function(e){"Upload Files"===le&&0!==Ae&&a("upload already in progress",{variant:"warning",action:function(e){return c.a.createElement(S.a,{variant:"contained",color:"error",size:"small",onClick:function(){document.dispatchEvent(new Event("abort-upload")),t(e)}},"cancel upload")},persist:!0}),Y(!1)},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description"},c.a.createElement(T.a,{sx:be,onDragOver:function(e){e.preventDefault(),"Upload Files"===le&&ge(Object(w.a)({},be,{border:"2px dashed red"}))},onDragLeave:function(e){e.preventDefault(),"Upload Files"===le&&ge(Object(w.a)({},be,{border:"2px solid white"}))},onDrop:function(e){if(e.preventDefault(),"Upload Files"===le){var n=Object(k.a)(e.dataTransfer.files);if(-1!=n.findIndex(function(e){if(_e.map(function(e){return e.name}).includes(e.name))return!0})){var r=a("can't upload 2 file with same name",{variant:"warning"});setTimeout(function(){t(r)},1e3)}else Ce([].concat(Object(k.a)(_e),Object(k.a)(n))),ge(Object(w.a)({},be,{border:"2px solid white"}))}}},c.a.createElement(d.a,{sx:{color:"red"},onClick:function(e){"Upload Files"===le&&0!==Ae&&a("upload already in progress",{variant:"warning",action:function(e){return c.a.createElement(S.a,{variant:"contained",color:"error",size:"small",onClick:function(){document.dispatchEvent(new Event("abort-upload")),t(e)}},"cancel upload")},persist:!0}),Y(!1)}},c.a.createElement(y.a,null,"close")),c.a.createElement(m.a,{id:"modal-modal-title",sx:{textAlign:"center"},variant:"h6",component:"h2"},le),c.a.createElement(O.a,{sx:{p:4}},"Upload Files"===le&&c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(xe,{InputElement:c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement("input",{id:"select-file-input",onChange:function(e){var n=-1,r=Object(k.a)(e.target.files);if(r.map(function(e){Pe.includes(e.name)&&(n+=1)}),-1!=n){var c=a("can't upload 2 file with same name",{variant:"warning"});setTimeout(function(){t(c)},1e3)}else Ce([].concat(Object(k.a)(_e),Object(k.a)(r)));e.target.value=""},type:"file",style:{display:"none"},multiple:!0}),c.a.createElement("label",{htmlFor:"select-file-input"},c.a.createElement(S.a,{variant:"outlined",component:"span",style:{width:"100%"}},"Select File"))),chipData:Pe,setChipData:Ue,itemPlaceholder:"files"}))),"New Folder"===le&&c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{placeholder:"name",onChange:function(e){return qe(Object(w.a)({},Me,{name:e.target.value}))},sx:{marginTop:"20px"},startAdornment:c.a.createElement(y.a,{sx:{marginRight:"20px"}},"folder")})),c.a.createElement(A.a,{sx:{width:"100%",marginTop:"20px"}},c.a.createElement(xe,{startAdornment:c.a.createElement(y.a,{sx:{marginRight:"20px"}},"person_add"),itemPlaceholder:"access list",placeholder:"username to access",chipData:ve,setChipData:we})),"Change Access"!==le&&c.a.createElement(D.a,{sx:{marginTop:"10px",marginLeft:"2px"},label:"public",control:c.a.createElement(c.a.Fragment,null,c.a.createElement(y.a,null,"folder_shared"),c.a.createElement(I.a,{onChange:function(e){return qe(Object(w.a)({},Me,{public:e.target.checked}))}}))}),c.a.createElement(A.a,{sx:{width:"100%"}},0===Ae?c.a.createElement(S.a,{variant:"contained",color:"success",sx:{margin:"20px auto",width:"100%"},onClick:function(e){if(e.preventDefault(),"Change Access"===le){var n={fid:Me.name,access:ve};i(re(n)),Y(!1)}else if("Upload Files"===le)!function(){var e=new FormData;for(var n in e.append("public",Me.public),e.append("parent",E),e.append("access",JSON.stringify(ve)),_e)e.append("files",_e[n]);var r=new XMLHttpRequest;r.onreadystatechange=function(){if(4==r.readyState&&r.responseText){var e=JSON.parse(r.responseText),n=0;e.ok?(n=a("".concat(_e.length," uploaded successfully"),{variant:"success"}),i(ee())):(n=e.error?a("".concat(e.error),{variant:"error"}):a("failed to upload all items",{variant:"error"}),i(ee())),Y(!1),setTimeout(function(){return t(n)},1e3)}},r.open("POST","/api/fobject/file/add",!0),r.upload.onprogress=function(e){if(e.lengthComputable){var a=Math.ceil(e.loaded/e.total*100);Fe(a)}},r.onabort=function(e){var n=a("upload aborted",{variant:"warning"});setTimeout(function(){return t(n)},1e3),Fe(0)};document.addEventListener("abort-upload",function e(a){r.abort(),document.removeEventListener("abort-upload",e)}),r.setRequestHeader("Authorization",l),r.send(e)}();else if("New Folder"===le){var r=Object(w.a)({},Me);if(r.parent=E,0!==ve.length&&(r.access=ve),-1===g.findIndex(function(e){return e.name===r.name}))i(ae(r)),Y(!1);else{var c=a("this folder already exist !",{variant:"error"});setTimeout(function(){t(c)},1e3)}}}},0!==Ae?"Cancel Upload":"Change Access"===le?"save":"New Folder"===le?"create":"Upload Files"===le?"upload":""):c.a.createElement(S.a,{variant:"contained",color:"error",sx:{margin:"20px auto",width:"100%"},onClick:function(){document.dispatchEvent(new Event("abort-upload"))}},"cancel upload"),"Upload Files"===le&&0!==Ae&&c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(P.a,{variant:"determinate",value:Ae})))))),c.a.createElement(U.a,{container:!0,sx:{color:"text.primary"}},g.map(function(e){return c.a.createElement(U.a,{key:e._id,item:!0,xl:3,lg:4,sm:6,xs:12,sx:{padding:"10px"}},c.a.createElement(L.a,{onDragStart:function(a){a.dataTransfer.setData("fid",e._id),a.dataTransfer.effectAllowed="move"},onDragOver:function(a){1===e.ftype&&a.preventDefault()},onDrop:function(a){var t=a.dataTransfer.getData("fid");Ne(t,e._id)},draggable:!0,sx:{width:"100%",borderRadius:"10px",backgroundColor:"background.primary"}},c.a.createElement(R.a,{avatar:c.a.createElement(M.a,{onClick:function(){G?i(de({fid:e._id})):0===e.ftype?0!==e.downloadValue?document.dispatchEvent(new Event("abort-download-".concat(e._id))):function(e){var n=new XMLHttpRequest;n.open("GET","/api/fobject/file/download/"+e._id,!0),n.responseType="blob",n.onload=function(){var r=URL.createObjectURL(n.response),c=document.createElement("a");c.href=r,c.download=e.name,c.click(),i(pe({fid:e._id,value:0}));var l=a("download complete",{variant:"success"});setTimeout(function(){return t(l)},1e3)},n.onprogress=function(a){if(a.lengthComputable){var t=Math.ceil(a.loaded/a.total*100);i(pe({fid:e._id,value:t}))}},n.onabort=function(n){var r=a("download aborted",{variant:"warning"});setTimeout(function(){return t(r)},1e3),i(pe({fid:e._id,value:0}))};document.addEventListener("abort-download-".concat(e._id),function a(t){n.abort(),document.removeEventListener("abort-download-".concat(e._id),a)}),n.setRequestHeader("Authorization",l),n.send()}(e):i(me(e._id))},sx:{bgcolor:"text.primary",cursor:"pointer"},"aria-label":"recipe"},0!==e.downloadValue?c.a.createElement(c.a.Fragment,null,c.a.createElement(q.a,{variant:"determinate",value:e.downloadValue,sx:{position:"absolute",color:"background.default"}}),c.a.createElement(y.a,null,"close")):c.a.createElement(y.a,null,e.checked?"check":0===e.ftype?"description":1===e.ftype?e.public?"share":e.owner===o._id?"folder":"folder_shared":"question_mark")),action:c.a.createElement(c.a.Fragment,null,c.a.createElement(d.a,{onClick:function(a){V(a.target),i(se({fid:e._id}))},"aria-label":"settings"},c.a.createElement(y.a,null,"more_vert")),c.a.createElement(p.a,{anchorEl:J,open:e.menu,onClose:function(){return i(se({fid:e._id}))}},c.a.createElement(b.a,{onClick:function(a){return we((t=e).access),qe(Object(w.a)({},Me,{name:t._id})),oe("Change Access"),void Y(!0);var t},sx:{padding:"10px"}},c.a.createElement(y.a,null,"lock_open"),c.a.createElement(m.a,{sx:{marginLeft:2}},"access control")),c.a.createElement(b.a,{sx:{padding:"10px"},onClick:function(){i(ne({fid:e._id}))}},c.a.createElement(y.a,null,"share"),c.a.createElement(m.a,{sx:{marginLeft:2}},"share folder")),c.a.createElement(b.a,{onClick:function(){i(de({fid:e._id})),i(se({fid:e._id}))},sx:{padding:"10px"}},c.a.createElement(y.a,null,"check_box"),c.a.createElement(m.a,{sx:{marginLeft:2}},"select")),c.a.createElement(b.a,{onClick:function(){i(te({fid:e._id}))},sx:{padding:"10px"}},c.a.createElement(y.a,null,"delete"),c.a.createElement(m.a,{sx:{marginLeft:2}},"remove")))),title:e.name,subheader:e.createdAt})))})))}var ke=t(186);function ye(){var e=Object(N.f)(),a=Object(z.b)(),t=Object(z.c)(function(e){return e.request.response}),l=Object(r.useState)({state:!1,code:null}),o=Object(n.a)(l,2),i=o[0],u=o[1],s=Object(r.useState)(!1),d=Object(n.a)(s,2),f=d[0],p=d[1],b=Object(r.useState)({name:"",username:"",password:"",email:""}),g=Object(n.a)(b,2),h=g[0],E=g[1];return Object(r.useEffect)(function(){console.log(t),!i.state&&t.ok?u({state:!0,code:null}):i.state||t.ok||p(!1)},[t]),Object(r.useEffect)(function(){u({state:!1,code:null}),E({name:"",username:"",password:"",email:""}),p(!1)},[]),c.a.createElement(T.a,{elevation:24,sx:{margin:"10vh auto",width:"fit-content"}},c.a.createElement(m.a,{variant:"h2",sx:{textAlign:"center",padding:"40px 0 0 0"}},"Register"),c.a.createElement(O.a,{sx:{width:"25vw",margin:"0 auto",padding:"20px 30px 0 30px"}},i.state?c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(ke.a,{label:"activation code",sx:{marginTop:"10px"},onChange:function(e){return u(Object(w.a)({},i,{code:e.target.value}))}})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(S.a,{variant:"contained",sx:{margin:"30px auto",width:"50%"},onClick:function(e){return a(K({username:h.username,code:i.code}))}},"Verify"))):c.a.createElement(c.a.Fragment,null,c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{placeholder:"name",sx:{marginTop:"20px"},onChange:function(e){return E(Object(w.a)({},h,{name:e.target.value}))},startAdornment:c.a.createElement(y.a,{sx:{marginRight:"20px"}},"badge")})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{placeholder:"username",sx:{marginTop:"10px"},onChange:function(e){return E(Object(w.a)({},h,{username:e.target.value}))},startAdornment:c.a.createElement(y.a,{sx:{marginRight:"20px"}},"person")})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{placeholder:"email",sx:{marginTop:"10px"},onChange:function(e){return E(Object(w.a)({},h,{email:e.target.value}))},startAdornment:c.a.createElement(y.a,{sx:{marginRight:"20px"}},"mail")})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{type:"password",placeholder:"password",sx:{marginTop:"10px"},onChange:function(e){return E(Object(w.a)({},h,{password:e.target.value}))},startAdornment:c.a.createElement(y.a,{sx:{marginRight:"20px"}},"key")})),c.a.createElement(A.a,{sx:{width:"100%"}},f?c.a.createElement(S.a,{variant:"contained",sx:{margin:"30px auto 0 auto",width:"50%"}},c.a.createElement(q.a,{color:"secondary"})):c.a.createElement(S.a,{variant:"contained",sx:{margin:"30px auto 0 auto",width:"50%"},onClick:function(e){p(!0),a(W(h))}},"register")),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(S.a,{sx:{margin:"20px auto",width:"50%"},onClick:function(a){return e("/login")}},"have account?")))))}function _e(){var e=Object(N.f)(),a=Object(z.b)(),t=Object(r.useState)({username:"",password:""}),l=Object(n.a)(t,2),o=l[0],i=l[1];return c.a.createElement(T.a,{elevation:24,sx:{margin:"10vh auto",width:"fit-content"},spacing:12},c.a.createElement(m.a,{variant:"h2",sx:{textAlign:"center",padding:" 40px 0 0 0"}},"Login"),c.a.createElement(O.a,{sx:{width:"25vw",margin:"0 auto",padding:"0 30px"}},c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{placeholder:"username",onChange:function(e){return i(Object(w.a)({},o,{username:e.target.value}))},sx:{marginTop:"50px"},startAdornment:c.a.createElement(y.a,{sx:{marginRight:"20px"}},"person")})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{type:"password",onChange:function(e){return i(Object(w.a)({},o,{password:e.target.value}))},placeholder:"password",sx:{marginTop:"20px"},startAdornment:c.a.createElement(y.a,{sx:{marginRight:"20px"}},"key")})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(S.a,{variant:"contained",sx:{margin:"50px auto 0 auto",width:"50%"},onClick:function(e){return a(G(o))}},"Login")),c.a.createElement(A.a,{sx:{width:"100%"}},"   ",c.a.createElement(S.a,{sx:{margin:"20px auto",width:"50%"},onClick:function(a){return e("/register")}},"or register ?"))))}var Ce=t(214),Se=t(197),Te=t(215),Ae=t(216),Fe=t(217),De=t(218),Ie=t(219),Pe=t(220),Ue=t(221),Le=Object(J.b)({name:"users",initialState:{data:[]},reducers:{setUsers:function(e,a){e.data=a.payload},checkUser:function(e,a){e.data=e.data.map(function(e){return e.username===a.payload.username&&(e.checked=a.payload.value),e})},checkAllUser:function(e,a){e.data=e.data.map(function(e){return Object(w.a)({},e,{checked:a.payload.value})})}}}),Re=Le.actions,Me=Re.setUsers,qe=Re.checkUser,ze=Re.checkAllUser,Ne=Le.reducer,Je={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",color:"text.default",border:"1px solid white",borderRadius:"15px",p:4};function Ve(){var e=Object(z.b)(),a=Object(z.c)(function(e){return e.users.data}),t=Object(r.useState)(!1),l=Object(n.a)(t,2),o=l[0],i=l[1],u=Object(r.useState)({identifier:null,data:{name:"",username:"",password:"",email:"",verify:!1}}),s=Object(n.a)(u,2),f=s[0],p=s[1],b=Object(r.useState)("edit"),g=Object(n.a)(b,2),h=g[0],E=g[1],v=Object(r.useState)(!1),x=Object(n.a)(v,2),j=x[0],k=x[1],_=Object(r.useState)(!1),P=Object(n.a)(_,2),U=P[0],L=P[1];Object(r.useEffect)(function(){e(Z())},[]),Object(r.useEffect)(function(){i(!1),p({identifier:null,data:{name:"",username:"",password:"",email:"",verify:!1}}),E("edit");var e=0;a.forEach(function(a){return a.checked&&e++}),e===a.length?L(!0):L(!1),k(0!==e)},[a]);return c.a.createElement("div",null,c.a.createElement(c.a.Fragment,null,c.a.createElement(Ce.a,{onClick:function(){E("New"),p({identifier:null,data:{name:"",username:"",password:"",email:"",verify:!1}}),i(!0)},color:"secondary",sx:{position:"fixed",right:"30px",bottom:"30px"}},c.a.createElement(y.a,null,"person_add")),j&&c.a.createElement(Ce.a,{onClick:function(t){var n=a.filter(function(e){return e.checked}).map(function(e){return e.username});e($({usernames:n}))},color:"error",sx:{position:"fixed",right:"30px",bottom:"100px"}},c.a.createElement(y.a,null,"delete_forever")),c.a.createElement(C.a,{open:o,onClose:function(e){i(!1)},"aria-labelledby":"modal-modal-title","aria-describedby":"modal-modal-description"},c.a.createElement(T.a,{sx:Je},c.a.createElement(d.a,{sx:{color:"red"},onClick:function(e){i(!1)}},c.a.createElement(y.a,null,"close")),c.a.createElement(m.a,{id:"modal-modal-title",sx:{textAlign:"center"},variant:"h6",component:"h2"},h," User"),c.a.createElement(O.a,{sx:{p:4}},c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{placeholder:"name",value:f.data.name,onChange:function(e){return p(Object(w.a)({},f,{data:Object(w.a)({},f.data,{name:e.target.value})}))},sx:{marginTop:"20px"},startAdornment:c.a.createElement(y.a,{sx:{mr:2}},"badge")})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{placeholder:"username",value:f.data.username,onChange:function(e){return p(Object(w.a)({},f,{data:Object(w.a)({},f.data,{username:e.target.value})}))},sx:{marginTop:"10px"},startAdornment:c.a.createElement(y.a,{sx:{mr:2}},"person")})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{placeholder:"email",value:f.data.email,onChange:function(e){return p(Object(w.a)({},f,{data:Object(w.a)({},f.data,{email:e.target.value})}))},sx:{marginTop:"10px"},startAdornment:c.a.createElement(y.a,{sx:{mr:2}},"mail")})),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(F.a,{type:"password",placeholder:"password",sx:{marginTop:"10px"},value:f.data.password,onChange:function(e){return p(Object(w.a)({},f,{data:Object(w.a)({},f.data,{password:e.target.value})}))},startAdornment:c.a.createElement(y.a,{sx:{mr:2}},"key")})),c.a.createElement(D.a,{sx:{marginTop:"10px",marginLeft:"10px"},label:"verify",control:c.a.createElement(c.a.Fragment,null,c.a.createElement(y.a,null,"verified"),c.a.createElement(I.a,{checked:f.data.verify,onClick:function(e){return p(Object(w.a)({},f,{data:Object(w.a)({},f.data,{verify:!f.data.verify})}))}}))}),c.a.createElement(A.a,{sx:{width:"100%"}},c.a.createElement(S.a,{variant:"contained",color:"success",sx:{margin:"20px auto",width:"100%"},onClick:function(t){if("New"===h)e(Q(f.data));else if("Edit"===h){var n={},r=a.findIndex(function(e){return e.username===f.identifier}),c=a[r];for(var l in c)c[l]!==f.data[l]&&(n[l]=f.data[l]);n.uid=f.identifier,e(Y(n))}}},"save"))))),c.a.createElement(Se.a,null,c.a.createElement(Te.a,null,c.a.createElement(Ae.a,{sx:{minWidth:650},"aria-label":"simple table"},c.a.createElement(Fe.a,null,c.a.createElement(De.a,null,c.a.createElement(Ie.a,null,c.a.createElement(I.a,{checked:U,onClick:function(){e(ze(U?{value:!1}:{value:!0}))},checkedIcon:c.a.createElement(y.a,null,"indeterminate_check_box")})),c.a.createElement(Ie.a,null,"name"),c.a.createElement(Ie.a,null,"username"),c.a.createElement(Ie.a,null,"email"),c.a.createElement(Ie.a,null,"verified"),c.a.createElement(Ie.a,null,"action"))),c.a.createElement(Pe.a,null,a.map(function(t){return c.a.createElement(De.a,{key:t.username},c.a.createElement(Ie.a,null,c.a.createElement(I.a,{checked:t.checked,onClick:function(n){return function(t){var n=0;a.forEach(function(a){return a.username===t.username&&e(qe({username:a.username,value:!a.checked})),a.checked&&(n+=1),a}),k(0!==n)}(t)}})),c.a.createElement(Ie.a,null,t.name),c.a.createElement(Ie.a,null,t.username),c.a.createElement(Ie.a,null,t.email),c.a.createElement(Ie.a,null,t.verify?c.a.createElement(y.a,null,"check"):c.a.createElement(y.a,null,"close")," "),c.a.createElement(Ie.a,null,c.a.createElement(Ue.a,null,c.a.createElement(S.a,{size:"small",color:"warning",variant:"contained",onClick:function(a){return e($({usernames:[t.username]}))}},"delete"),c.a.createElement(S.a,{size:"small",color:"info",variant:"contained",onClick:function(){E("Edit"),p({identifier:t.username,data:t}),i(!0)}},"edit"))))})))))))}t(135);var He=localStorage.getItem("theme")||"light",Be=Object(J.b)({name:"config",initialState:{theme:He,sideMenu:!1},reducers:{toggleTheme:function(e){e.theme="dark"===e.theme?"light":"dark",localStorage.setItem("theme",e.theme)},toggleSideMenu:function(e){e.sideMenu=!e.sideMenu}}}),Ge=Be.actions,We=Ge.toggleTheme,Xe=Ge.toggleSideMenu,Ke=Be.reducer,Qe=localStorage.getItem("user")?{data:JSON.parse(localStorage.getItem("user"))}:{data:{_id:null,name:null,username:null,email:null,role:0}},Ye=Object(J.b)({name:"user",initialState:Qe,reducers:{setUser:function(e,a){if(null===a.payload)return localStorage.removeItem("user"),void(e.data={_id:null,name:null,username:null,email:null,role:0});var t=Object(w.a)({},a.payload);for(var n in t.hasOwnProperty("password")&&delete t.password,t)e.data[n]=t[n];localStorage.setItem("user",JSON.stringify(e.data))}}}),Ze=Ye.actions.setUser,$e=Ye.reducer;function ea(e){var a=Object(z.c)(function(e){return e.user.data}),t=Object(r.useState)({name:"",username:"",email:"",password:""}),l=Object(n.a)(t,2),o=l[0],i=l[1];return Object(r.useEffect)(function(){i(Object(w.a)({},a))},[a]),c.a.createElement(Se.a,null,c.a.createElement(U.a,{container:!0},c.a.createElement(T.a,{sx:{margin:"10vh auto",padding:"5vh 0",width:"60%",display:"flex",alignItems:"center",flexDirection:"column"}},c.a.createElement(A.a,{sx:{width:"80%",mt:2}},c.a.createElement(ke.a,{value:o.name,label:"name",onChange:function(e){i(Object(w.a)({},o,{name:e.target.value}))}})),c.a.createElement(A.a,{sx:{width:"80%",mt:2}},c.a.createElement(ke.a,{value:o.username,label:"username",onChange:function(e){i(Object(w.a)({},o,{username:e.target.value}))}})),c.a.createElement(A.a,{sx:{width:"80%",mt:2}},c.a.createElement(ke.a,{value:o.email,label:"email",onChange:function(e){i(Object(w.a)({},o,{email:e.target.value}))}})),c.a.createElement(A.a,{sx:{width:"80%",mt:2}},c.a.createElement(ke.a,{value:o.password,label:"password",onChange:function(e){i(Object(w.a)({},o,{password:e.target.value}))}})),c.a.createElement(A.a,{sx:{width:"80%",mt:2}},c.a.createElement(S.a,null,"save")))))}var aa=function(){var e=Object(N.f)(),a=Object(z.c)(function(e){return e.config.theme}),t=Object(z.c)(function(e){return e.config.sideMenu}),l=Object(z.c)(function(e){return e.request.jwt}),o=Object(z.c)(function(e){return e.user.data.role}),w=Object(z.b)(),k=Object(r.useState)(null),_=Object(n.a)(k,2),C=_[0],S=_[1],T=function(){S(null)};return c.a.createElement(c.a.Fragment,null,c.a.createElement(i.a,null),c.a.createElement(u.a,{position:"sticky"},c.a.createElement(s.a,null,l&&2===o?c.a.createElement(d.a,{onClick:function(e){return w(Xe())},size:"large",edge:"start",color:"inherit","aria-label":"menu",sx:{mr:2}},c.a.createElement(y.a,null,"menu")):"",c.a.createElement(m.a,{variant:"h6",component:"div",sx:{flexGrow:1}},c.a.createElement(f.a,{href:"/",underline:"hover",color:"inherit",style:{cursor:"pointer"}},"Smart Storage")),c.a.createElement(d.a,{color:"inherit",onClick:function(e){return w(We())}},c.a.createElement(y.a,null,"dark"===a?"dark_mode":"light_mode")),l?c.a.createElement(d.a,{color:"inherit",onClick:function(e){S(e.currentTarget)}},c.a.createElement(y.a,null,"account_circle")):c.a.createElement(c.a.Fragment,null),c.a.createElement(p.a,{id:"menu-appbar",anchorEl:C,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:Boolean(C),onClose:T},c.a.createElement(b.a,{onClick:function(){e("/profile"),T()}},"Profile"),c.a.createElement(b.a,{onClick:function(){w(B(null)),w(Ze(null)),e("/login"),T()}},"Logout")))),c.a.createElement(g.a,{anchor:"left",open:t,onClose:function(e){return w(Xe())}},c.a.createElement(h.a,null,c.a.createElement(E.a,null,c.a.createElement(d.a,{onClick:function(e){return w(Xe())}},c.a.createElement(y.a,null,"chevron_left"))),c.a.createElement(v.a,null),c.a.createElement(E.a,null,c.a.createElement(x.a,{onClick:function(a){return e("/manage/user")}},c.a.createElement(j.a,null,c.a.createElement(y.a,null,"manage_accounts")),"user management")),c.a.createElement(E.a,null,c.a.createElement(x.a,{onClick:function(a){return e("/")}},c.a.createElement(j.a,null,c.a.createElement(y.a,null,"folder")),"file management")))),c.a.createElement(O.a,null,c.a.createElement(N.c,null,c.a.createElement(N.a,{path:"/",element:c.a.createElement(we,null)}),c.a.createElement(N.a,{path:"profile",element:c.a.createElement(ea,null)}),2===o&&c.a.createElement(N.a,{path:"manage/user",element:c.a.createElement(Ve,null)}),c.a.createElement(N.a,{path:"login",element:c.a.createElement(_e,null)}),c.a.createElement(N.a,{path:"register",element:c.a.createElement(ye,null)}))))},ta=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,224)).then(function(a){var t=a.getCLS,n=a.getFID,r=a.getFCP,c=a.getLCP,l=a.getTTFB;t(e),n(e),r(e),c(e),l(e)})},na=t(101),ra=Object(na.a)({palette:{mode:"dark",background:{default:"#0A1929",secondary:"#33577d",primary:"#02664b"},text:{primary:"#fff"}}}),ca=Object(na.a)({palette:{mode:"light",background:{secondary:"#49a9b8",primary:"#5afacf"}}}),la=Object(J.a)({reducer:{config:Ke,user:$e,users:Ne,request:le,storage:be}}),oa=t(198),ia=t(45);var ua=function(){var e=Object(je.b)(),a=e.enqueueSnackbar,t=e.closeSnackbar,n=Object(z.c)(function(e){return e.request}),c=Object(z.b)(),l=Object(N.f)();return Object(r.useEffect)(function(){if(null!=n&&""!==n.route){var e={method:n.method,headers:{"content-type":"application/json"}};n.auth&&(e.headers.Authorization=n.jwt),e.body=n.data?JSON.stringify(n.data):"",fetch(n.route,e).then(function(e){return e.json()}).then(function(e){var r=0;switch(c(X(e)),n.route){case"/api/user/login":e.ok?(r=a("welcom",{variant:"success"}),c(B(e.data)),c(Ze(e.user)),l("/")):r=a(e.error,{variant:"error"});break;case"/api/user/register":e.ok?(r=a("verify your mail address",{variant:"info"}),c(Ze(n.data))):r=a(e.error,{variant:"error"});break;case"/api/user/verify":e.ok?(r=a("your account verified successfully",{variant:"success"}),setTimeout(function(){l("/login")},4e3)):r=a(e.error,{variant:"error"});break;case"/api/user/list":e.ok?c(Me(e.data.map(function(e){return Object(w.a)({},e,{checked:!1})}))):r=a(e.error,{variant:"error"});break;case"/api/user/add":e.ok?(c(Z()),r=a("new user added successfully",{variant:"success"})):r=a(e.error,{variant:"error"});break;case"/api/user/edit":e.ok?(c(Z()),r=a("user updated successfully",{variant:"success"})):r=a(e.error,{variant:"error"});break;case"/api/user/remove":e.ok?(c(Z()),r=a("user deleted successfully",{variant:"success"})):r=a(e.error,{variant:"error"});break;case"/api/fobject/list":e.ok?c(ue(e.data)):r=a(e.error,{variant:"error"});break;case"/api/fobject/remove":e.ok?(c(ee()),r=a("item deleted successfully",{variant:"success"})):r=a(e.error,{variant:"error"});break;case"/api/fobject/folder/add":e.ok?(c(ee()),r=a("new folder created successfully",{variant:"success"})):r=a(e.error,{variant:"error"});break;case"/api/fobject/access/public":e.ok?(c(ee()),r=a("public access ".concat(e.data.public?"enabled":"disabled"),{variant:"success"})):r=a(e.error,{variant:"error"});break;case"/api/fobject/access/change":e.ok?(c(ee()),r=a("changing access success",{variant:"success"})):r=a(e.error,{variant:"error"});break;case"/api/fobject/move":e.ok?(c(ee()),r=a("moving items successfull",{variant:"success"})):r=a(e.error,{variant:"error"})}0!==r&&setTimeout(function(){t(r)},3e3)}).catch(function(e){return console.log(e)})}},[n.route,n.data]),null};function sa(){var e=Object(r.useState)(ca),a=Object(n.a)(e,2),t=a[0],l=a[1],o=Object(z.c)(function(e){return e.config.theme});return Object(r.useEffect)(function(){"light"===o?l(ca):"dark"===o&&l(ra)},[o]),c.a.createElement(oa.a,{theme:t},c.a.createElement(ia.a,null,c.a.createElement(je.a,{maxSnack:3},c.a.createElement(ua,null),c.a.createElement(aa,null))))}o.a.createRoot(document.getElementById("root")).render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(z.a,{store:la},c.a.createElement(sa,null)))),ta(console.log)}},[[119,1,2]]]);
//# sourceMappingURL=main.837d2ea2.chunk.js.map